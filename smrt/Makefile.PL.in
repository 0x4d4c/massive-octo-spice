use 5.011000;
use ExtUtils::MakeMaker;

sub MY::libscan {
    my( $mm, $file ) = @_;
    return if $file =~  /\.(swp|log|in)$/; # SKIP
    return $file;
}

sub MY::postamble {
    return <<'MAKE_FRAG';

fixperms:
	chmod 0770 $(DESTDIR)$(sysconfdir)/rules
	chown -R $(CIF_USER) $(DESTDIR)$(sysconfdir)/rules
	chgrp -R $(CIF_GROUP) $(DESTDIR)$(sysconfdir)/rules

install-rules:
	[ -d $(DESTDIR)$(sysconfdir)/rules ] || $(INSTALL) -m 0770 -d $(DESTDIR)$(sysconfdir)/rules
	-( cd rules && find . -type d -print ) | while read dir ; do \
		$(INSTALL) -m 0770 -d "$(DESTDIR)$(sysconfdir)/rules/$$dir" ; \
	done
	-( cd rules && find . -type f -print ) | while read file ; do \
		$(INSTALL) -m 0660 "rules/$$file" "$(DESTDIR)$(sysconfdir)/rules/$$file" ; \
	done

clean-local:
	find . -name '*.log' -delete

MAKE_FRAG
}

# See lib/ExtUtils/MakeMaker.pm for details of how to influence
# the contents of the Makefile that is written.
WriteMakefile(
    NAME            => 'CIF::Smrt',
    VERSION         => '@CIF_VERSION@',
    EXE_FILES       => ['bin/cif-smrt'],
    NO_META         => 1,
    NO_MYMETA       => 1,
);
